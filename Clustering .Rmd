---
title: "R Notebook"
output: html_notebook
---
```{r}

```

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
plot(cars)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

```{r}
link = 'https://raw.githubusercontent.com/Group-6-542/EmilyRepository/50e2502dfe3fde3a633f8ca193eb0c6ff76aafe5/mergedGroupDataFinal.csv'
myfile = url(link)
fromPy = read.csv(file = myfile)
row.names(fromPy) = NULL
dfClus = fromPy[,c( 'casesReported', 'numberOfPets', 'numberOfReturns', 'avgAGI', 'culturalSpaces')]
summary(dfClus)
```

```{r}
dfClus=scale(dfClus) #standardization scale
summary(dfClus)
```
```{r}
row.names(dfClus)=fromPy$zipcode

head(dfClus)
```
```{r}
set.seed(999) #for randomization
library(cluster)
dfClus_D=cluster::daisy(x=dfClus) #distance calculated
dfClus_D #using distance for partioning technique
```
```{r}
NumCluster=4
res.pam = pam(x=dfClus_D,
              k = NumCluster,
              cluster.only = F) #get all information
fromPy$pam=as.factor(res.pam$clustering)
fromPy[fromPy$pam==1,'zipcode'] #group1 countries
```

```{r}
library(factoextra)

fviz_silhouette(res.pam)
```
```{r}
#Save individual silhouettes:
pamEval=data.frame(res.pam$silinfo$widths)
head(pamEval)
#Save individual silhouettes:
pamEval[pamEval$sil_width<0,]
```


```{r}
library(factoextra)
#Hierarchizing: Agglomerative

res.agnes= hcut(dfClus_D, 
                k = NumCluster,isdiss=T,
                hc_func='agnes',
                hc_method = "ward.D2")
fromPy$agn=as.factor(res.agnes$cluster)
```

```{r}
fromPy[fromPy$agn==1,'zipcode']
```

```{r}
#report: table of clusters
table(fromPy$agn)
```


```{r}
#dendogram
fviz_dend(res.agnes,k=NumCluster, cex = 0.7, horiz = T)
```
```{r}
#average sillhouettes
library(factoextra)
fviz_silhouette(res.agnes)
```
```{r}
#saving
agnEval=data.frame(res.agnes$silinfo$widths)
head(agnEval)
```
```{r}
#requesting negative
agnEval[agnEval$sil_width<0,]
```
```{r}
#Hierarchizing: divisive
library(factoextra)

res.diana= hcut(dfClus_D, k = NumCluster,
                 hc_func='diana',
                 hc_method = "ward.D")

fromPy$dia=as.factor(res.diana$cluster)
table(fromPy$dia)
```

```{r}
fviz_dend(res.diana,k=NumCluster, cex = 0.7, horiz = T)
```

```{r}
library(factoextra)
fviz_silhouette(res.diana)
```
```{r}
#saving sillhouettes
diaEval=data.frame(res.diana$silinfo$widths)
head(diaEval)
```

```{r}
#reporting negative sillhouettes
diaEval[diaEval$sil_width<0,]
```

```{r}
#Density Based Clustering
library(dbscan)
#minNeighs>= num cols in data
minNeighs=4
kNNdistplot(dfClus_D, k = minNeighs)
abline(h=0.3, col = "red", lty=2)
#line not showing here
```
```{r}
distance=0.3
res.db = dbscan::dbscan(dfClus_D, 
                        eps=distance, 
                        minPts=minNeighs)
```

```{r}
#how many clusters were produced
#zero means outliers
res.db

```

```{r}
fromPy$db=as.factor(res.db$cluster)

```

